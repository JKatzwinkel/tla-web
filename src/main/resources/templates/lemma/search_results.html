<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base}"
>
  <head>
    <title>Lemma Search</title>
  </head>

  <body>

    <div layout:fragment="content">

      <div class="search-header">
        <p th:replace="fragments/search :: result-page-desc"/>
      </div>

      <div class="row">
        <div class="col-lg-8 content">
          <div class= "result-list m-4">
            <nav th:replace="fragments/search :: search-results-pagination"/>

            <div th:each="obj : ${searchResults}" class="result-list-item" th:id="${obj.id}" th:object="${obj}">

              <a th:replace="fragments/common :: review-state(${obj})"/>

              <div>
                <!-- line 1 -->
                <h2 class="result-list-item-element transcription bbaw-libertine" th:text="*{name}">nfr</h2>
                <span class="result-list-item-element hieroglyphs">
                  <span th:replace="fragments/details :: hieroglyphs">N35:G43</span>
                </span>
                <span class="result-list-item-element lemma-id">
                  (ID<span class="ml-1" th:text="*{id}">33410</span>)
                </span>
              </div>

              <div>
                <!-- line 2 -->
                <span class="result-list-item-element word-class font-italic font-weight-light">
                  <span th:replace="fragments/details :: lemma-pos">Part of speech</span>
                </span>
                <span class="result-list-item-element translations">
                  <th:block th:each="entry : *{translations}" th:insert="fragments/common :: single-lang-translation(${entry})"/>
                </span>
                <span class="result-list-item-element attested-timespan" th:unless="*{timespan} == null">
                  <span th:text="*{timespan.begin}">begin</span>
                  <span>&mdash;</span>
                  <span th:text="*{timespan.end}">end</span>
                </span>
                <span class="result-list-item-element bibliography">
                  (<span th:each="bibl : *{bibliography}" class="bibliographic-reference" th:text="${bibl}">Bib. ref</span>)
                </span>
              </div>

              <hr/>
            </div>

            <nav th:replace="fragments/search :: search-results-pagination"/>
          </div>
        </div>

        <!-- sidebar -->
        <div class="col-lg-4 sidebar">
          <div class="sticky-top m-4">

            <div style="display: none">
              <!-- hidden form for storage of search parameters -->
              <form th:replace="fragments/search :: #dict-search"/>
            </div>

            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <label class="input-group-text" for="select-sort-order">Order by</label>
              </div>
              <select class="custom-select select-sort-order" id="select-sort-order" th:field="${searchQuery.sort}" form="dict-search">
                <option th:each="value : ${sortOrders}" th:value="${value}" th:text="#{|field_value_label_sort_by_${value}_type_lemma|}">Alphabetic asc.</option>
                <script th:inline="javascript">
                  //<![CDATA[
                  $('#select-sort-order').change(
                    () => {
                      $('form#dict-search').submit();
                    }
                  );
                  //]]>
                </script>
              </select>
              <div class="input-group-append" style="display: none">
                <button class="btn btn-block btn-secondary text-left text-decoration-none" form="dict-search" id="submit-sort-order" type="submit">
                  <span class="fas fa-arrow-circle-right"></span>
                  <span>Apply</span>
                </button>
              </div>
            </div>

            <div class="hide-properties-buttons">
              <button th:each="property : ${hideableProperties}" type="button" class="btn btn-secondary btn-block text-left" th:id="|hide-property-button-${property}|">
                <i class="fas on" th:classappend="fa-plus-circle"></i>
                <i class="fas off" th:classappend="fa-minus-circle"></i>
                <span th:text="#{|button_label_hide_property_${property}|}">Property name</span>
                <script th:inline="javascript">
                  //<![CDATA[
                  {
                    let name = /*[[${property}]]*/ null;
                    let button = $(`#hide-property-button-${name}`);
                    button.children('i.on').toggle();
                    button.click(() => {
                      $(`.result-list-item-element.${name}`).toggle();
                      button.children('svg').toggle();
                    });
                  }
                  //]]>
                </script>
              </button>
            </div>

            <div>
              <a th:href="${modifySearchUrl}">
                <button type="button" class="btn btn-block btn-red text-left text-decoration-none modify-search-btn">
                  <span class="fas fa-arrow-circle-left"></span>
                  <span>Modify search</span>
                </button>
              </a>
            </div>

          </div>
        </div>
      </div>

    </div>

  </body>
</html>